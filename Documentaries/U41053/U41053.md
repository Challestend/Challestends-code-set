吞噬阳光之塔



会（gu）有（gu）的（gu）。



鹀黑巫鸟回想起来，祂当初进入无现里时，被阐里鹤喰以考验为由扔到了一个奇怪的地方。祂想要再现当时的情景，却已经无法回忆起全部细节了。于是，祂将祂当时所在的地方抽象成一条数轴，每一个正整数点代表着一块区域，进入这块区域可以获得一定的收益。具体来说，如果黑巫鸟进入第$i$块区域，祂可以获得$w_i$的收益。所有的$w_i$都是$32$位有符号整数。鹤喰依次给出了数条命令，每条命令有两个参数$l,r$，意思是说，让黑巫鸟从$[l,r]$中任选一块区域进入，然后向$x$轴正方向走，经过若干块区域后，从任意一块区域离开，并最大化祂的收益。特别的，黑巫鸟必须至少经过一块区域，并且整个过程中不能走到$[l,r]$之外。有些时候，鹤喰还会临时修改某些区域的收益，并且每次修改只会修改一块区域。

如果事情只是这样，鹤喰完全可以任意地控制黑巫鸟的收益多少。幸运的是，黑巫鸟拥有「颠倒黑白」这样的能力。在祂进入每一块区域之前，祂可以使用一次这个能力，令所有$w_i$按位取反。就比如说，$(-2147483648)_{10}=(10000000000000000000000000000000)_2$按位取反之后就是$(2147483647)_{10}=(01111111111111111111111111111111)_2$。当然，使用能力不是没有代价的，黑巫鸟每使用一次这种能力，就需要付出$k$的代价。

黑巫鸟不擅长这种问题，于是祂找到了你，让你帮祂计算一下每个任务的（收益-代价）最大是多少，来让祂对比一下祂当时采取的行动如何。



第一行包含$3$个整数$n,m,k$，依次表示区域的数量，发生的事件的数量，以及黑巫鸟每次使用能力的代价。

第二行包含$n$个整数，第$i$个整数表示$w_i$。

接下来$m$行，每行会先给出一个整数$opt$，表示事件的类型。

1. 如果$opt$为$1$，表示鹤喰给出了一条新的命令，接下来有两个整数，依次为$l,r$。
2. 如果$opt$为$2$，表示鹤喰修改了一块区域的收益，接下来有两个整数，依次为$x,y$，意思是将$w_x$修改为$y$。



对于鹤喰给出的每一条命令，输出一行，仅包含一个整数，表示（收益-代价）的最大值。



## 样例#$1$解释

一共有$5$个区域，`w[]={2147483647,2147483647,-1,-2147483648,-1}`。

我们来逐个事件分析。

`1 1 2`

$[1,2]$内所有区域的收益都是正的，最优策略就是从最左端走到最右端。

`2 3 -2147483648`

`w[]={2147483647,2147483647,-2147483648,-2147483648,-1}`。

`1 1 5`

最优策略是从$1$走到$2$，使用一次能力，然后再从$3$走到$4$，（收益-代价）$=4\times 2147483647-2147483646=6442450942$。仅仅只是从$1$走到$2$并不是最优的，因为这种策略的（收益-代价）$=2\times 2147483647=4294967294<6442450942$。

`2 5 2147483647`

`w[]={2147483647,2147483647,-2147483648,-2147483648,2147483647}`。

`1 1 5`

最优策略是从$1$走到$2$，使用第一次能力，然后再从$3$走到$4$，使用第二次能力，最后走到$5$，（收益-代价）$=5\times 2147483647-2\times 2147483646=6442450943$。