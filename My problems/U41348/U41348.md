伸缩窗口



$\text{Challestend}$刚刚学习了莫队算法，突然灵机一动，出了这么一道题并逼你把它做出来。



给定一条长为$n$的线段$[1,n]$，并给定它的$m$条子线段（或者是其上的一个点）。现在你有一个伸缩窗口，顾名思义，它是一个窗口，并且，它可以伸缩。具体来说，将这个窗口的左端点记为$l$，右端点记为$r$，它所框住的区间也就是$[l,r]$。初始时，你可以任意指定$l$，$r$的值，在这之后的每一个时刻，你能且仅能执行以下四种操作之一

- 操作$A$：将窗口的左端点向内收缩一个单位长度，执行完该操作后，其框住的区间变为$[l+1,r]$
- 操作$B$：将窗口的左端点向外拉伸一个单位长度，执行完该操作后，其框住的区间变为$[l-1,r]$
- 操作$C$：将窗口的右端点向内收缩一个单位长度，执行完该操作后，其框住的区间变为$[l,r-1]$
- 操作$D$：将窗口的右端点向外拉伸一个单位长度，执行完该操作后，其框住的区间变为$[l,r+1]$

不过，你必须保证对于任意时刻，$1\leqslant l\leqslant r\leqslant n$总是成立，即$[l,r]$总是$[1,n]$的一条子线段（或者是其上的一个点）。

当然，以上这些操作都是有代价的，不过，这个代价并不是一个常数，如果这是你第$k$次连续执行某操作，你需要付出的代价是$2k-1$。

对于上面给定的某一条子线段，如果在任意一个时刻，它__恰好__被你的伸缩窗口所框住，你就能获得一定的收益。对于输入顺序的第$i$条子线段，它所对应的收益是$w_i$。对于每一条子线段，你仅能且必须获取一次收益，你需要是最大化总收益与总代价的差。