## 基础四则运算练习题

### 题目背景

Chimuzu省选一轮爆了两个大零蛋，于是滚回去学文化课了。

他翻出一道基础四则运算练习题……然后发现自己不会。

于是他需要你的帮助，作为回报，他会给你$100$分。

### 题目描述

Chimuzu手上有一个数字序列$\{a_{1},a_{2},\cdots,a_{n-1},a_{n}\}$和一个运算符序列$\{p_{1},p_{2},\cdots,p_{n-1}\}$。其中$p_{i}$只能为$+$或$\times$。

我们定义一个区间$[l,r]$的权值$W_{l,r}$为将字符串

$$a_{l} p_{l} a_{l+1} p_{l+1} \cdots a_{r-1} p_{r-1} a_{r}$$

写下来之后，按照运算符的优先级计算出的结果。就比如说

$$a=\{2,4,8,16,32,64\}$$

$$p=\{+,\times,\times,+,\times\}$$

$$W_{1,6}=2+4\times 8\times 16+32\times 64=2562$$

$$W_{3,6}=8\times 16+32\times 64=2176$$

Chimuzu需要你对这两个序列进行修改，同时查询某个给定区间的权值。

### 输入输出格式

##### 输入格式

第一行包含两个整数$n,m$。

第二行包含$n$个整数$a_{1},a_{2},\cdots,a_{n-1},a_{n}$。

第三行包含$n-1$个整数$p_{1},p_{2},\cdots,p_{n-1}$，$0$表示$+$，$1$表示$\times$。

接下来$m$行，每行有一个操作，有如下三种情况：

1. $1$ $l$ $r$ $x$：将$a_{l},a_{l+1},\cdots,a_{r}$全部修改成$x$。
2. $2$ $l$ $r$ $y$：将$p_{l},p_{l+1},\cdots,p_{r}$全部修改成$y$，$0$表示$+$，$1$表示$\times$。
3. $3$ $l$ $r$：查询$W_{l,r}\operatorname{mod}2^{32}$的值。

##### 输出格式

对于每一次操作$3$，输出一行一个整数。

### 输入输出样例

##### 输入样例#1

```
6 6
2 4 8 16 32 64
0 1 1 0 1
3 1 6
3 3 6
1 1 2 128
2 3 4 1
3 1 6
3 3 6
```

##### 输出样例#1

```
2562
2176
33554560
262144
```

##### 样例解释#1

初始的两个序列和前两次操作是题目描述中的例子。第四次操作结束后，两个序列变成了如下形态

$$a=\{128,128,8,16,32,64\}$$

$$p=\{+,\times,\times,\times,\times\}$$

$$W_{1,6}=128+128\times 8\times 16\times 32\times 64=33554560$$

$$W_{3,6}=8\times 16\times 32\times 64=262144$$

##### 输入样例#2

```
20 20
757147 167851000 301413356 336971124 659598368 160567225 391749387 4890851 35766290 26239572 473038164 597006 361554432 6051436 392289610 118341522 170427798 37215528 675016433 168544290
1 0 0 1 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0
1 6 13 222071040
3 1 9
3 13 19
1 3 18 225450720
1 2 20 513494528
1 6 7 318773940
1 1 6 48581612
3 5 9
1 1 20 288159399
2 7 9 0
3 13 17
1 9 19 139695684
1 17 17 103301480
1 1 13 39202254
3 1 5
3 9 13
1 3 13 108977344
1 5 5 690847794
3 3 19
1 1 20 278570942
```

##### 输出样例#2

```
598522015
623169014
944782397
442552642
182146519
196011270
916996828
```

### 说明

##### 数据范围与约定

对于$10\%$的数据，$n,m\leqslant 2000$。

对于另外$10\%$的数据，$y=1$。

对于另外$10\%$的数据，不存在操作$1$。

对于$100\%$的数据，$n,m\leqslant 100000$，$1\leqslant a_{i},x\lt 2^{32}$，$p_{i},y\in\{0,1\}$，$1\leqslant l\leqslant r\leqslant n$，所有操作$2$还满足$r\lt n$。
